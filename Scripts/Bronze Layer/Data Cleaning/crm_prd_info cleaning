INSERT INTO Silver.crm_prd_info (
prd_id,
cat_id,
prd_key,
prd_nm,
prd_cost,
prd_line,
prd_start_dt,
prd_end_dt)
SELECT 
prd_id,
REPLACE (SUBSTRING (prd_key,1,5), '-','_')As cat_id,
SUBSTRING (prd_key, 7, LEN (prd_key)) As prd_key,
prd_nm,
ISNULL(prd_cost,0) AS prd_cost,
CASE UPPER(TRIM(prd_line ))
	WHEN 'R' Then 'Road'
	WHEN 'M' Then 'Mountain'
	WHEN 'S' Then 'Other Sales'
	WHEN 'T' Then 'Touring'
	else 'N/A' END AS prd_line,
prd_start_dt,
CAST (LEAD(prd_start_dt) OVER (PARTITION BY prd_key ORDER BY prd_start_dt) As DATE) AS prd_end_dt
From bronze.crm_prd_info
